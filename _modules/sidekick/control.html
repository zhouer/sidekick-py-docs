

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>sidekick.control &mdash; Sidekick Python Library 0.0.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=282f96c0"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Sidekick Python Library
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">API Reference:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">sidekick</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Project Links:</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/zhouer/Sidekick">GitHub Repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://pypi.org/project/sidekick-py/">PyPI Package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Sidekick Python Library</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">sidekick.control</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for sidekick.control</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Provides the Control class for adding interactive UI elements to Sidekick.</span>

<span class="sd">Use the `sidekick.Control` class to create a dedicated panel within the Sidekick</span>
<span class="sd">UI where you can programmatically add simple user interface controls like buttons</span>
<span class="sd">and labeled text input fields.</span>

<span class="sd">This allows your Python script to present interactive options to the user directly</span>
<span class="sd">within the Sidekick panel, enabling you to:</span>

<span class="sd">*   Create buttons (`add_button`) that trigger specific Python functions when</span>
<span class="sd">    clicked in the Sidekick UI.</span>
<span class="sd">*   Add text input fields (`add_text_input`) where users can type information,</span>
<span class="sd">    which is then sent back to your Python script for processing when they click</span>
<span class="sd">    the associated submit button.</span>

<span class="sd">Use the `on_click()` and `on_input_text()` methods to register callback functions</span>
<span class="sd">that define how your Python script should react to these user interactions.</span>

<span class="sd">Example Scenario:</span>
<span class="sd">Imagine building a simple simulation. You could use a `Control` panel to add:</span>

<span class="sd">*   A &quot;Start Simulation&quot; button.</span>
<span class="sd">*   A &quot;Reset Simulation&quot; button.</span>
<span class="sd">*   A text input field labeled &quot;Enter Speed:&quot; with a &quot;Set Speed&quot; button.</span>

<span class="sd">Your Python script would then use `on_click` and `on_input_text` to run the</span>
<span class="sd">appropriate simulation logic or update speed variables when the user interacts</span>
<span class="sd">with these controls in Sidekick.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.base_module</span><span class="w"> </span><span class="kn">import</span> <span class="n">BaseModule</span>

<div class="viewcode-block" id="Control">
<a class="viewcode-back" href="../../sidekick.html#sidekick.control.Control">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Control</span><span class="p">(</span><span class="n">BaseModule</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represents a Control panel module instance in the Sidekick UI.</span>

<span class="sd">    This class creates a container in the Sidekick panel specifically designed</span>
<span class="sd">    to hold simple interactive controls added dynamically from your Python script.</span>
<span class="sd">    Use its methods (`add_button`, `add_text_input`) to populate the panel, and</span>
<span class="sd">    `on_click` / `on_input_text` to define the Python functions that respond to</span>
<span class="sd">    user interactions with those controls.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        target_id (str): The unique identifier for this control panel instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Control.__init__">
<a class="viewcode-back" href="../../sidekick.html#sidekick.control.Control.__init__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">instance_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">spawn</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the Control panel object and optionally creates the UI element.</span>

<span class="sd">        Sets up an empty panel ready to receive controls via methods like `add_button`.</span>
<span class="sd">        Establishes the connection to Sidekick if not already done.</span>

<span class="sd">        Args:</span>
<span class="sd">            instance_id (Optional[str]): A specific ID for this control panel instance.</span>
<span class="sd">                - If `spawn=True` (default): Optional. If None, a unique ID (e.g.,</span>
<span class="sd">                  &quot;control-1&quot;) is generated automatically.</span>
<span class="sd">                - If `spawn=False`: **Required**. Must match the ID of an existing</span>
<span class="sd">                  control panel element in the Sidekick UI to attach to.</span>
<span class="sd">            spawn (bool): If True (the default), a command is sent to Sidekick</span>
<span class="sd">                to create a new, empty control panel UI element. If False, the</span>
<span class="sd">                library assumes a panel with the given `instance_id` already exists,</span>
<span class="sd">                and this Python object simply connects to it.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `spawn` is False and `instance_id` is not provided.</span>
<span class="sd">            SidekickConnectionError (or subclass): If the connection to Sidekick</span>
<span class="sd">                cannot be established during initialization.</span>

<span class="sd">        Examples:</span>
<span class="sd">            &gt;&gt;&gt; # Create a new panel to hold buttons and inputs</span>
<span class="sd">            &gt;&gt;&gt; sim_controls = sidekick.Control(instance_id=&quot;simulation-controls&quot;)</span>
<span class="sd">            &gt;&gt;&gt; sim_controls.add_button(&quot;start_btn&quot;, &quot;Run Simulation&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Attach to an existing panel (e.g., created by another script)</span>
<span class="sd">            &gt;&gt;&gt; existing_panel = sidekick.Control(instance_id=&quot;shared-controls&quot;, spawn=False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># The initial spawn command for a Control panel currently doesn&#39;t require</span>
        <span class="c1"># any specific payload data, as it just creates an empty container.</span>
        <span class="n">spawn_payload</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">spawn</span> <span class="k">else</span> <span class="kc">None</span>

        <span class="c1"># Initialize the base class (handles connection, ID, registration, spawn).</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">module_type</span><span class="o">=</span><span class="s2">&quot;control&quot;</span><span class="p">,</span>
            <span class="n">instance_id</span><span class="o">=</span><span class="n">instance_id</span><span class="p">,</span>
            <span class="n">spawn</span><span class="o">=</span><span class="n">spawn</span><span class="p">,</span>
            <span class="n">payload</span><span class="o">=</span><span class="n">spawn_payload</span><span class="p">,</span> <span class="c1"># Send empty payload if spawning</span>
        <span class="p">)</span>
        <span class="c1"># --- Initialize Callbacks ---</span>
        <span class="c1"># Placeholders for the user-defined callback functions.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_callback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_text_callback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Log initialization.</span>
        <span class="n">spawn_info</span> <span class="o">=</span> <span class="s2">&quot;new panel&quot;</span> <span class="k">if</span> <span class="n">spawn</span> <span class="k">else</span> <span class="s2">&quot;attaching to existing&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control panel &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39; initialized (</span><span class="si">{</span><span class="n">spawn_info</span><span class="si">}</span><span class="s2">).&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_internal_message_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handles incoming &#39;event&#39; or &#39;error&#39; messages for this control panel. (Internal).</span>

<span class="sd">        Overrides the base class method to specifically process &#39;click&#39; and</span>
<span class="sd">        &#39;inputText&#39; events originating from controls (buttons, inputs) added</span>
<span class="sd">        to this panel. It uses the `controlId` field within the message payload</span>
<span class="sd">        to identify which specific control triggered the event. Based on the</span>
<span class="sd">        event type (&#39;click&#39; or &#39;inputText&#39;), it calls the corresponding registered</span>
<span class="sd">        user callback (`on_click` or `on_input_text`), passing the `controlId`</span>
<span class="sd">        (and the submitted text value for `inputText`) as arguments.</span>

<span class="sd">        It delegates to the base class&#39;s handler (`super()._internal_message_handler`)</span>
<span class="sd">        at the end to ensure standard &#39;error&#39; message processing still occurs.</span>

<span class="sd">        Args:</span>
<span class="sd">            message (Dict[str, Any]): The raw message dictionary received. Expected</span>
<span class="sd">                payload keys are camelCase.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg_type</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="n">message</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;payload&quot;</span><span class="p">)</span> <span class="c1"># Payload keys expected to be camelCase.</span>

        <span class="c1"># Handle &#39;event&#39; messages specifically</span>
        <span class="k">if</span> <span class="n">msg_type</span> <span class="o">==</span> <span class="s2">&quot;event&quot;</span><span class="p">:</span>
            <span class="n">event_type</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">payload</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="c1"># CRITICAL: Get the ID of the specific button or input that triggered the event.</span>
            <span class="n">control_id</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;controlId&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">payload</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="c1"># We *must* have a controlId to know which element was interacted with.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">control_id</span><span class="p">:</span>
                 <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control panel &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39; received event message without required &#39;controlId&#39;: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                 <span class="c1"># Cannot dispatch without knowing the source control, but still process potential errors.</span>
                 <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_internal_message_handler</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                 <span class="k">return</span> <span class="c1"># Stop further processing of this event.</span>

            <span class="c1"># --- Dispatch based on event type and registered callback ---</span>
            <span class="k">if</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;click&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_click_callback</span><span class="p">:</span>
                <span class="c1"># Handle button clicks</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Call the user&#39;s click handler, passing the ID of the clicked button.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_click_callback</span><span class="p">(</span><span class="n">control_id</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># Catch errors within the user&#39;s callback.</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error occurred inside Control &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39; on_click callback for control &#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">elif</span> <span class="n">event_type</span> <span class="o">==</span> <span class="s2">&quot;inputText&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input_text_callback</span><span class="p">:</span>
                <span class="c1"># Handle text input submissions</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Extract the submitted text value.</span>
                    <span class="n">submitted_text</span> <span class="o">=</span> <span class="n">payload</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">)</span>
                    <span class="c1"># Ensure the value is a string before calling the callback.</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">submitted_text</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                        <span class="c1"># Call the user&#39;s input handler, passing the control ID and the text.</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_input_text_callback</span><span class="p">(</span><span class="n">control_id</span><span class="p">,</span> <span class="n">submitted_text</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39; received &#39;inputText&#39; for &#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s2">&#39; with non-string value: </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># Catch errors within the user&#39;s callback.</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error occurred inside Control &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39; on_input_text callback for control &#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Log if we receive an event type we don&#39;t handle for this control ID,</span>
                <span class="c1"># or if the corresponding callback wasn&#39;t registered.</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39;: Received unhandled event &#39;</span><span class="si">{</span><span class="n">event_type</span><span class="si">}</span><span class="s2">&#39; for control &#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s2">&#39; or no callback registered.&quot;</span><span class="p">)</span>

        <span class="c1"># ALWAYS call the base class handler. This is crucial for processing</span>
        <span class="c1"># &#39;error&#39; messages sent from the UI related to this specific control panel.</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_internal_message_handler</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<div class="viewcode-block" id="Control.on_click">
<a class="viewcode-back" href="../../sidekick.html#sidekick.control.Control.on_click">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_click</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Registers a function to call when any button within this panel is clicked.</span>

<span class="sd">        When a user clicks a button (previously added using `add_button()`) in</span>
<span class="sd">        the Sidekick UI panel that belongs to this `Control` instance, the `callback`</span>
<span class="sd">        function you provide here will be executed within your running Python script.</span>

<span class="sd">        Args:</span>
<span class="sd">            callback (Optional[Callable[[str], None]]): The function to call</span>
<span class="sd">                when any button in this panel is clicked. This function must</span>
<span class="sd">                accept one argument:</span>
<span class="sd">                `control_id` (str): The unique identifier (the same ID you</span>
<span class="sd">                provided when calling `add_button`) of the specific button</span>
<span class="sd">                that was clicked.</span>
<span class="sd">                Pass `None` to remove any previously registered click callback.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If the provided `callback` is not a callable function (or `None`).</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; controls = sidekick.Control()</span>
<span class="sd">            &gt;&gt;&gt; controls.add_button(&quot;action_one&quot;, &quot;Perform Action 1&quot;)</span>
<span class="sd">            &gt;&gt;&gt; controls.add_button(&quot;action_two&quot;, &quot;Do Something Else&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; def button_handler(button_that_was_clicked):</span>
<span class="sd">            ...     print(f&quot;Button clicked: {button_that_was_clicked}&quot;)</span>
<span class="sd">            ...     if button_that_was_clicked == &quot;action_one&quot;:</span>
<span class="sd">            ...         # Run action 1 logic...</span>
<span class="sd">            ...         print(&quot;Running action 1...&quot;)</span>
<span class="sd">            ...     elif button_that_was_clicked == &quot;action_two&quot;:</span>
<span class="sd">            ...         # Run action 2 logic...</span>
<span class="sd">            ...         print(&quot;Doing something else...&quot;)</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; controls.on_click(button_handler)</span>
<span class="sd">            &gt;&gt;&gt; sidekick.run_forever() # Keep script running</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided on_click callback must be a callable function or None.&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting on_click callback for control panel &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_callback</span> <span class="o">=</span> <span class="n">callback</span></div>


<div class="viewcode-block" id="Control.on_input_text">
<a class="viewcode-back" href="../../sidekick.html#sidekick.control.Control.on_input_text">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_input_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">]]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Registers a function to call when text is submitted from any text input field within this panel.</span>

<span class="sd">        When a user types text into an input field (previously added using</span>
<span class="sd">        `add_text_input()`) within this `Control` instance&#39;s panel and clicks</span>
<span class="sd">        its associated &quot;Submit&quot; button in the Sidekick UI, the `callback` function</span>
<span class="sd">        you provide here will be executed in your running Python script.</span>

<span class="sd">        Args:</span>
<span class="sd">            callback (Optional[Callable[[str, str], None]]): The function to call</span>
<span class="sd">                when text is submitted from any input field in this panel. This</span>
<span class="sd">                function must accept two arguments:</span>
<span class="sd">                1. `control_id` (str): The unique identifier (the same ID you</span>
<span class="sd">                   provided when calling `add_text_input`) of the specific text</span>
<span class="sd">                   input group whose submit button was clicked.</span>
<span class="sd">                2. `value` (str): The text string that the user had entered into</span>
<span class="sd">                   the input field when they submitted it.</span>
<span class="sd">                Pass `None` to remove any previously registered input text callback.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If the provided `callback` is not a callable function (or `None`).</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; controls = sidekick.Control()</span>
<span class="sd">            &gt;&gt;&gt; controls.add_text_input(&quot;param_a&quot;, placeholder=&quot;Parameter A&quot;)</span>
<span class="sd">            &gt;&gt;&gt; controls.add_text_input(&quot;param_b&quot;, placeholder=&quot;Parameter B&quot;, button_text=&quot;Set B&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; def input_handler(input_field_id, submitted_value):</span>
<span class="sd">            ...     print(f&quot;Input received from &#39;{input_field_id}&#39;: &#39;{submitted_value}&#39;&quot;)</span>
<span class="sd">            ...     if input_field_id == &quot;param_a&quot;:</span>
<span class="sd">            ...         # Process parameter A...</span>
<span class="sd">            ...         print(f&quot;Setting A to {submitted_value}&quot;)</span>
<span class="sd">            ...     elif input_field_id == &quot;param_b&quot;:</span>
<span class="sd">            ...         # Process parameter B...</span>
<span class="sd">            ...         print(f&quot;Setting B to {submitted_value}&quot;)</span>
<span class="sd">            ...</span>
<span class="sd">            &gt;&gt;&gt; controls.input_text_handler(input_handler)</span>
<span class="sd">            &gt;&gt;&gt; sidekick.run_forever() # Keep script running</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">callback</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;The provided on_input_text callback must be a callable function or None.&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting on_input_text callback for control panel &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_text_callback</span> <span class="o">=</span> <span class="n">callback</span></div>


    <span class="c1"># --- Error Callback ---</span>
    <span class="c1"># Inherits the on_error(callback) method directly from BaseModule.</span>
    <span class="c1"># Use `controls.on_error(my_handler)` to register a function that will be</span>
    <span class="c1"># called if the Control panel UI element itself reports an error back to Python</span>
    <span class="c1"># (e.g., if it failed to process an &#39;add&#39; or &#39;remove&#39; command internally).</span>

<div class="viewcode-block" id="Control.add_button">
<a class="viewcode-back" href="../../sidekick.html#sidekick.control.Control.add_button">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">button_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a clickable button to this control panel in the Sidekick UI.</span>

<span class="sd">        Creates a button element within this `Control` instance&#39;s panel area.</span>
<span class="sd">        Clicking this button in the Sidekick UI will trigger the function</span>
<span class="sd">        registered using `on_click()`, passing this button&#39;s unique `control_id`</span>
<span class="sd">        to the callback function.</span>

<span class="sd">        Args:</span>
<span class="sd">            control_id (str): A unique identifier string for this specific button</span>
<span class="sd">                within this control panel. This ID is chosen by you and is crucial</span>
<span class="sd">                for identifying which button was pressed in the `on_click` callback.</span>
<span class="sd">                It must be a non-empty string.</span>
<span class="sd">            button_text (str): The text label that will appear visibly on the button in the UI.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `control_id` is empty or not a string.</span>
<span class="sd">            SidekickConnectionError (or subclass): If sending the command fails.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; controls = sidekick.Control()</span>
<span class="sd">            &gt;&gt;&gt; controls.add_button(&quot;start_sim&quot;, &quot;Start Simulation&quot;)</span>
<span class="sd">            &gt;&gt;&gt; controls.add_button(&quot;reset_sim&quot;, &quot;Reset&quot;)</span>
<span class="sd">            &gt;&gt;&gt; # Add an on_click handler to react to these buttons...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate the control_id provided by the user.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">control_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">control_id</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Control ID for add_button must be a non-empty string.&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Ensure text is explicitly a string for the payload.</span>
        <span class="n">button_label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">button_text</span><span class="p">)</span>

        <span class="c1"># Prepare the payload for the &#39;update&#39; command to add the control.</span>
        <span class="c1"># Keys must be camelCase for the communication protocol.</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;add&quot;</span><span class="p">,</span>          <span class="c1"># Command type: add a new control</span>
            <span class="s2">&quot;controlId&quot;</span><span class="p">:</span> <span class="n">control_id</span><span class="p">,</span>  <span class="c1"># The unique ID for this new button</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;controlType&quot;</span><span class="p">:</span> <span class="s2">&quot;button&quot;</span><span class="p">,</span>       <span class="c1"># Specify the type of control being added</span>
                <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>                    <span class="c1"># Configuration settings specific to this control type</span>
                    <span class="s2">&quot;buttonText&quot;</span><span class="p">:</span> <span class="n">button_label</span> <span class="c1"># The text label for the button</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1"># Send the command using the base class helper. Raises on connection error.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_update</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39;: Sent &#39;add&#39; command for button &#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Control.add_text_input">
<a class="viewcode-back" href="../../sidekick.html#sidekick.control.Control.add_text_input">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_text_input</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">placeholder</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">initial_value</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">button_text</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds a text input field paired with a submit button to the control panel.</span>

<span class="sd">        Creates a combined UI element in the Sidekick panel consisting of a text entry</span>
<span class="sd">        box and an adjacent button (labeled with `button_text`). When the user types</span>
<span class="sd">        text into the field and clicks the associated submit button, the function</span>
<span class="sd">        registered using `on_input_text()` is triggered. That callback function</span>
<span class="sd">        receives both this control&#39;s `control_id` and the text the user entered.</span>

<span class="sd">        Args:</span>
<span class="sd">            control_id (str): A unique identifier string for this specific text input</span>
<span class="sd">                group (the field + button combination) within this control panel.</span>
<span class="sd">                This ID is passed to the `on_input_text` callback. Must be a</span>
<span class="sd">                non-empty string.</span>
<span class="sd">            placeholder (str): Optional text displayed faintly inside the input field</span>
<span class="sd">                when it&#39;s empty, providing a hint to the user (e.g., &quot;Enter name&quot;).</span>
<span class="sd">                Defaults to &quot;&quot;.</span>
<span class="sd">            initial_value (str): Optional text pre-filled in the input field when it</span>
<span class="sd">                first appears in the UI. Defaults to &quot;&quot;.</span>
<span class="sd">            button_text (str): Optional text label displayed on the submit button that&#39;s</span>
<span class="sd">                associated with this input field.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `control_id` is empty or not a string.</span>
<span class="sd">            SidekickConnectionError (or subclass): If sending the command fails.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; controls = sidekick.Control()</span>
<span class="sd">            &gt;&gt;&gt; # Add a simple text input with a placeholder</span>
<span class="sd">            &gt;&gt;&gt; controls.add_text_input(&quot;search_term&quot;, placeholder=&quot;Enter search query...&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; # Add an input with an initial value and a custom button label</span>
<span class="sd">            &gt;&gt;&gt; controls.add_text_input(&quot;server_ip&quot;, initial_value=&quot;192.168.1.1&quot;, button_text=&quot;Set IP&quot;)</span>
<span class="sd">            &gt;&gt;&gt; # Add an on_input_text handler to react to these inputs...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate the control_id provided by the user.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">control_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">control_id</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Control ID for add_text_input must be a non-empty string.&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Ensure other text parameters are explicitly strings for the payload.</span>
        <span class="n">input_placeholder</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">placeholder</span><span class="p">)</span>
        <span class="n">input_initial_value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">initial_value</span><span class="p">)</span>
        <span class="n">submit_button_label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">button_text</span><span class="p">)</span>

        <span class="c1"># Prepare the payload for adding the text input control.</span>
        <span class="c1"># Keys must be camelCase for the protocol.</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;add&quot;</span><span class="p">,</span>          <span class="c1"># Command type: add a new control</span>
            <span class="s2">&quot;controlId&quot;</span><span class="p">:</span> <span class="n">control_id</span><span class="p">,</span>  <span class="c1"># The unique ID for this new input group</span>
            <span class="s2">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;controlType&quot;</span><span class="p">:</span> <span class="s2">&quot;textInput&quot;</span><span class="p">,</span> <span class="c1"># Specify the type of control being added</span>
                <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="p">{</span>                 <span class="c1"># Configuration settings specific to text inputs</span>
                    <span class="s2">&quot;placeholder&quot;</span><span class="p">:</span> <span class="n">input_placeholder</span><span class="p">,</span>
                    <span class="s2">&quot;initialValue&quot;</span><span class="p">:</span> <span class="n">input_initial_value</span><span class="p">,</span>
                    <span class="s2">&quot;buttonText&quot;</span><span class="p">:</span> <span class="n">submit_button_label</span><span class="p">,</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1"># Send the command using the base class helper. Raises on connection error.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_update</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39;: Sent &#39;add&#39; command for text input &#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Control.remove_control">
<a class="viewcode-back" href="../../sidekick.html#sidekick.control.Control.remove_control">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">remove_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">control_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a specific control (button or text input) from this panel in the UI.</span>

<span class="sd">        Use this method to dynamically remove a button or text input field that</span>
<span class="sd">        was previously added using `add_button()` or `add_text_input()`. You must</span>
<span class="sd">        provide the same unique `control_id` that you used when adding the control.</span>

<span class="sd">        Args:</span>
<span class="sd">            control_id (str): The unique identifier string of the control element</span>
<span class="sd">                (button or text input group) that you want to remove from the</span>
<span class="sd">                Sidekick UI panel. Must be a non-empty string matching the ID used</span>
<span class="sd">                during creation.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If `control_id` is empty or not a string.</span>
<span class="sd">            SidekickConnectionError (or subclass): If sending the command fails.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; controls = sidekick.Control()</span>
<span class="sd">            &gt;&gt;&gt; controls.add_button(&quot;temporary_task&quot;, &quot;Run Once&quot;)</span>
<span class="sd">            &gt;&gt;&gt; # ... some logic runs ...</span>
<span class="sd">            &gt;&gt;&gt; # Now remove the button as it&#39;s no longer needed</span>
<span class="sd">            &gt;&gt;&gt; controls.remove_control(&quot;temporary_task&quot;)</span>
<span class="sd">            &gt;&gt;&gt;</span>
<span class="sd">            &gt;&gt;&gt; controls.add_text_input(&quot;user_pin&quot;, &quot;PIN&quot;)</span>
<span class="sd">            &gt;&gt;&gt; # ... user enters PIN and it&#39;s processed ...</span>
<span class="sd">            &gt;&gt;&gt; controls.remove_control(&quot;user_pin&quot;) # Remove the input field</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate the control_id provided by the user.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">control_id</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">control_id</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Control ID for remove_control must be a non-empty string.&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Prepare the payload for the &#39;remove&#39; action targeting a specific control.</span>
        <span class="c1"># Keys must be camelCase.</span>
        <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;remove&quot;</span><span class="p">,</span>       <span class="c1"># Command type: remove an existing control</span>
            <span class="s2">&quot;controlId&quot;</span><span class="p">:</span> <span class="n">control_id</span>   <span class="c1"># Specify which control ID to remove</span>
            <span class="c1"># No further &#39;options&#39; are typically needed for the &#39;remove&#39; action targeting a specific control.</span>
        <span class="p">}</span>
        <span class="c1"># Send the command using the base class helper. Raises on connection error.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_send_update</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Control &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">target_id</span><span class="si">}</span><span class="s2">&#39;: Sent &#39;remove&#39; command for control &#39;</span><span class="si">{</span><span class="n">control_id</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span></div>


    <span class="k">def</span><span class="w"> </span><span class="nf">_reset_specific_callbacks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal: Resets control-panel-specific callbacks when the module is removed.</span>

<span class="sd">        Called automatically by the base class&#39;s `remove()` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Reset the callback references for this control panel.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_click_callback</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_input_text_callback</span> <span class="o">=</span> <span class="kc">None</span></div>


    <span class="c1"># --- Removal ---</span>
    <span class="c1"># Inherits the standard remove() method from BaseModule. Calling `controls.remove()`</span>
    <span class="c1"># will send a command to the Sidekick UI to remove this entire control panel instance</span>
    <span class="c1"># (including any controls currently inside it) and will perform local cleanup</span>
    <span class="c1"># (unregistering handlers, resetting callbacks).</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Enjan Chou.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>